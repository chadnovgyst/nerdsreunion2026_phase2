import{f as C,g as R,s as nt,a as w,b as ae,d as ue,e as ta,r as ba}from"../chunks/DscdaUK8.js";import{i as pe}from"../chunks/tUnkN8nb.js";import{c as ze,a as Oe,o as Le,b as ma}from"../chunks/DX2lUfdR.js";import{e as ye,u as j,aN as _a,N as Ce,a9 as Me,V as ha,r as ga,aO as ya,v as be,a as t,a7 as y,ac as F,s as a,C as Tt,ad as xe,z as o,A as i,y as l,w as lt,x as me,aa as Zt,aP as Ae,aQ as Se,d as $e,ae as wa}from"../chunks/CtXWJ4Rl.js";import{i as wt}from"../chunks/j1nT2hqj.js";import{s as fe,b as ne,c as Ne,a as de,j as xa,k as Re,m as le,n as da,o as Ze,q as Ea,u as Sa,w as za,f as Pe,v as ve,x as ka,y as ja,z as qa,A as Ca,g as $a,h as Ma,i as We}from"../chunks/CHXiOBr5.js";import La from"../chunks/DN3J-sCw.js";import Ta from"../chunks/BKbm5EfA.js";import Aa from"../chunks/BvbcL8L1.js";import Ra from"../chunks/CpqWQj0X.js";import Da from"../chunks/CMBHzUVU.js";import Pa from"../chunks/BNFRKsyx.js";import Ia from"../chunks/CvpCKVSJ.js";import Oa from"../chunks/DKqRZLee.js";import Na from"../chunks/e1t1TJwC.js";import Ba from"../chunks/pOAIlSuq.js";import Ua from"../chunks/CDr_-IW6.js";import Ha from"../chunks/DkwgWrlg.js";import Va from"../chunks/BdPnv_Ww.js";import Fa from"../chunks/Wp1az9L3.js";import Ka from"../chunks/BozMgj6L.js";import Ga from"../chunks/ChEK7k_d.js";import Ya from"../chunks/BT5hMKdo.js";import Wa from"../chunks/DZg2n5Gj.js";import Xa from"../chunks/B--_m8y4.js";import Ja from"../chunks/BPfJ8Mnp.js";import Za from"../chunks/BbyHsVxX.js";import Qa from"../chunks/D1dfjzr5.js";import tn from"../chunks/sTVjfoeb.js";import en from"../chunks/BJv4UY2l.js";import an from"../chunks/DqmJETbX.js";import nn from"../chunks/Dbr1vHU4.js";import on from"../chunks/DIrtYIXF.js";import rn from"../chunks/ZuxV2OeQ.js";import ln from"../chunks/BBQehyBW.js";import sn from"../chunks/CTUHu1i9.js";import cn from"../chunks/DgcN0BtG.js";import un from"../chunks/D89J0wRi.js";import dn from"../chunks/D3GOXJB7.js";import vn from"../chunks/KMlGcXzU.js";import fn from"../chunks/hyOVM0Ug.js";import pn from"../chunks/D_zlzWZC.js";import bn from"../chunks/DBEQdhVc.js";import mn from"../chunks/Kieb5-lA.js";import _n from"../chunks/nEnXKinN.js";import hn from"../chunks/t4Dmsr4x.js";import gn from"../chunks/CXnItg8R.js";import yn from"../chunks/DWD3NyID.js";import wn from"../chunks/BGVZ31-y.js";import xn from"../chunks/DK9tbYvT.js";import En from"../chunks/9Ve3I6w0.js";import Sn from"../chunks/DkuNIGT0.js";import zn from"../chunks/CuS-bfel.js";import kn from"../chunks/D7_Q8Xbe.js";import jn from"../chunks/BVE7Js9b.js";import qn from"../chunks/B-q0s-Uw.js";import{b as we}from"../chunks/BkcxXaB0.js";import{p as Kt,l as ra}from"../chunks/CvkxTUf8.js";import{b as la}from"../chunks/Dh8RSm7Z.js";function Ie(f,x,d){ye(()=>{var U=j(()=>x(f,d?.())||{});if(U?.destroy)return()=>U.destroy()})}function Cn(f,x,d=x){var U=new WeakSet;_a(f,"input",async X=>{var V=X?f.defaultValue:f.value;if(V=Xe(f)?Je(V):V,d(V),Ce!==null&&U.add(Ce),await Me(),V!==(V=x())){var S=f.selectionStart,v=f.selectionEnd,J=f.value.length;if(f.value=V??"",v!==null){var G=f.value.length;S===v&&v===J&&G>J?(f.selectionStart=G,f.selectionEnd=G):(f.selectionStart=S,f.selectionEnd=Math.min(v,G))}}}),(ha&&f.defaultValue!==f.value||j(x)==null&&f.value)&&(d(Xe(f)?Je(f.value):f.value),Ce!==null&&U.add(Ce)),ga(()=>{var X=x();if(f===document.activeElement){var V=ya??Ce;if(U.has(V))return}Xe(f)&&X===Je(f.value)||f.type==="date"&&!X&&!f.value||X!==f.value&&(f.value=X??"")})}function Xe(f){var x=f.type;return x==="number"||x==="range"}function Je(f){return f===""?null:+f}function sa(f){return typeof f=="string"?f?document.querySelector(f):null:f??null}function va(f,x="body"){let d=sa(x)??document.body;return d&&d.appendChild(f),{update(U){const X=sa(U)??document.body;X===d||!X||(f.parentNode&&f.parentNode.removeChild(f),X.appendChild(f),d=X)},destroy(){f.parentNode&&f.parentNode.removeChild(f)}}}var $n=C('<button type="button"> </button>'),Mn=C('<div class="radial svelte-furii8"><div class="radial-label svelte-furii8"> </div> <!></div>'),Ln=C('<div class="picker svelte-furii8"><button type="button" class="value-button svelte-furii8" aria-label="Favorability value"><span class="value-label svelte-furii8"> </span></button> <p class="hint svelte-furii8" aria-live="polite"> </p> <!></div>');function Tn(f,x){be(x,!1);const d=y(),U=y(),X=y(),V=y();let S=Kt(x,"value",8,null),v=Kt(x,"disabled",8,!1);const J=0,G=100,kt=Array.from({length:11},(e,n)=>n*10),jt=176,$t=62,At=kt.length;function Z(e){const n=e/At*Math.PI*2-Math.PI/2,s=Math.cos(n)*$t,g=Math.sin(n)*$t;return`translate(calc(-50% + ${s}px), calc(-50% + ${g}px))`}const Y=120,_t=120,zt=250,T=12,K="[data-result-pane]",ot="reunion:radial-channel",xt=ze();let p=y(!1),z=y(null),r=y(void 0),q=y(null),W=y(null),bt=y(""),st=!1,ct=0,_=y(null),$=null,O=!1,Et=0,Q=null;const St=e=>typeof e=="number"?e.toString().padStart(2,"0"):"??";function Gt(e){return xt("register",{element:e}),{destroy(){xt("unregister",{element:e})}}}function D(e){xt("commit",{value:e})}function qt(e){if(v())return;ht(!0);const n=typeof t(d)=="number"?t(d):0,s=Math.min(G,Math.max(J,n+e));a(r,s),D(s)}function Ot(e){if(v())return;const n=Math.abs(e.deltaY)+Math.abs(e.deltaX);if(t(p)){if(H(n))return;e.preventDefault();return}if(!O&&n>_t){O=!0,tt(!1);return}if(O)return;e.preventDefault();const s=e.ctrlKey?10:e.shiftKey?5:1;for(ct+=e.deltaY;ct<=-Y;)qt(s),ct+=Y;for(;ct>=Y;)qt(-s),ct-=Y}function Pt(e){if(v())return;const n=e.key.length===1&&e.key>="0"&&e.key<="9";switch(e.key){case"Enter":e.preventDefault(),e.stopPropagation(),t(_)!==null?vt():t(p)&&tt(!1),xt("advance",{direction:1});break;case"Tab":e.preventDefault(),e.stopPropagation(),t(p)&&tt(!1),xt("advance",{direction:e.shiftKey?-1:1});break;case" ":e.preventDefault(),e.stopPropagation(),tt(!0);break;case"Escape":t(p)?(e.preventDefault(),tt(!1)):t(_)!==null&&(e.preventDefault(),ht(!1));break;case"ArrowUp":case"ArrowRight":e.preventDefault(),e.stopPropagation(),qt(e.shiftKey?5:1);break;case"ArrowDown":case"ArrowLeft":e.preventDefault(),e.stopPropagation(),qt(e.shiftKey?-5:-1);break;case"Backspace":(t(_)!==null||typeof t(d)=="number"||t(d)===null)&&(e.preventDefault(),e.stopPropagation(),I());break;case"Delete":(t(_)!==null||typeof t(d)=="number"||t(d)===null)&&(e.preventDefault(),e.stopPropagation(),it());break;default:n&&(e.preventDefault(),e.stopPropagation(),k(e.key))}}function Yt(e){if(!t(p))return;const n=e.target;t(q)?.contains(n)||t(W)?.contains(n)||tt(!1)}function Bt(e){t(p)&&e.key==="Escape"&&(e.preventDefault(),tt(!1))}function Wt(e){if(!t(p))return;const n=Math.abs(e.deltaY)+Math.abs(e.deltaX);H(n)}function Xt(){st||(window.addEventListener("pointerdown",Yt,!0),window.addEventListener("keydown",Bt,!0),window.addEventListener("wheel",Wt,{passive:!0}),window.addEventListener("scroll",Ht,!0),window.addEventListener("resize",Ht,!0),st=!0)}function Ut(){st&&(window.removeEventListener("pointerdown",Yt,!0),window.removeEventListener("keydown",Bt,!0),window.removeEventListener("wheel",Wt),window.removeEventListener("scroll",Ht,!0),window.removeEventListener("resize",Ht,!0),st=!1)}async function Ht(){await yt()}async function yt(){if(!t(p)||!t(q)||(await Me(),!t(p)||!t(q)))return;const e=t(q).getBoundingClientRect(),n=jt,s=n/2;let g=e.top+e.height/2,E=e.left+e.width/2;const M=T,N=Rt(),pt=window.innerHeight-N-T,Ct=T,b=window.innerWidth-T,L=g-s,B=g+s,A=E-s,mt=E+s;let rt=0;L<M?rt=L-M:B>pt&&(rt=B-pt);let Lt=0;if(A<Ct?Lt=A-Ct:mt>b&&(Lt=mt-b),(Lt!==0||rt!==0)&&(window.scrollBy({top:rt,left:Lt,behavior:"auto"}),await Me(),!t(p)||!t(q)))return;const It=t(q).getBoundingClientRect();g=It.top+It.height/2,E=It.left+It.width/2;const Qt=T+s,ie=window.innerHeight-N-T-s,_e=T+s,se=window.innerWidth-T-s;g=Math.min(Math.max(g,Qt),ie),E=Math.min(Math.max(E,_e),se);const te=t(W)?.offsetParent instanceof HTMLElement?t(W).offsetParent.getBoundingClientRect():null,ee=te?.top??0,ce=te?.left??0,oe=g-ee,re=E-ce;a(bt,`top:${Math.round(oe)}px;left:${Math.round(re)}px;--overlay-size:${n}px;`)}function Rt(){const e=document.querySelector(K);if(!e)return 0;const n=e.getBoundingClientRect();if(n.top>=window.innerHeight)return 0;const s=Math.min(n.height,Math.max(0,window.innerHeight-Math.max(n.top,0)));return Math.max(0,s)}function tt(e){if(v())return;const n=e??!t(p);n!==t(p)&&(a(p,n),t(p)?(Dt(),O=!1,ut(),a(_,null),$=null,a(z,typeof t(d)=="number"?t(d):null),a(r,void 0),ct=0,Xt(),yt()):(a(z,null),a(bt,""),Ut(),ut()))}function Jt(e){v()||(a(_,null),$=null,a(r,e),D(e),a(z,e),tt(!1))}Oe(()=>{Ut(),ut()}),Le(()=>{const e=n=>P(n);return window.addEventListener(ot,e),()=>{window.removeEventListener(ot,e)}});function h(){t(_)===null&&($=typeof t(d)=="number"?t(d):S()??null,typeof t(d)=="number"?a(_,t(d).toString()):typeof $=="number"?a(_,$.toString()):a(_,""))}function m(e){const n=e.replace(/\D/g,"").slice(0,3);if(n.length===0){a(_,""),a(r,null),D(null);return}const s=Number.parseInt(n,10),g=s>G?G:s;if(s>G&&n.length>0){a(_,String(Math.floor(s/10))),a(r,Number.parseInt(t(_),10)),D(t(r));return}a(_,g.toString()),a(r,g),D(g)}function k(e){h();const n=t(_)??"",s=n+e,g=Number.parseInt(s,10);!Number.isNaN(g)&&g>G&&n!==""||m(s)}function I(){h();const e=t(_)??"";if(e.length===0){a(_,""),a(r,null),D(null);return}m(e.slice(0,-1))}function it(){h(),a(_,""),a(r,null),D(null)}function vt(){t(_)!==null&&(a(_,null),$=null)}function ht(e){if(t(_)===null)return;const n=$;a(_,null),$=null,!e&&n!==S()?(a(r,n??null),D(n??null)):e||a(r,void 0)}function ut(){Et=0,Q&&(clearTimeout(Q),Q=null)}function H(e){return t(p)?(Et+=e,Q&&clearTimeout(Q),Q=window.setTimeout(()=>{Et=0,Q=null},zt),Et>=_t?(O||(O=!0),tt(!1),ut(),!0):!1):!1}function Dt(){if(typeof window>"u")return;const e={source:t(q)};window.dispatchEvent(new CustomEvent(ot,{detail:e}))}function P(e){!t(p)||e.detail?.source===t(q)||tt(!1)}F(()=>(t(r),Tt(S())),()=>{t(r)!==void 0&&S()===t(r)&&a(r,void 0)}),F(()=>(t(r),Tt(S())),()=>{a(d,t(r)===void 0?S():t(r))}),F(()=>(Tt(v()),t(d)),()=>{a(U,v()?"disabled":t(d)===null?"empty":t(d)<J||t(d)>G?"invalid":"valid")}),F(()=>t(U),()=>{a(X,t(U)==="invalid"?"Keep between 0 and 100.":"")}),F(()=>(t(_),t(d)),()=>{a(V,t(_)!==null?t(_)===""?"??":t(_):St(t(d)))}),xe(),pe();var et=Ln(),dt=o(et),Nt=o(dt),Vt=o(Nt,!0);i(Nt),i(dt),ye(()=>R("click",dt,()=>tt())),ye(()=>R("keydown",dt,Pt)),ye(()=>R("auto-open",dt,()=>tt(!0))),Ie(dt,e=>Gt?.(e)),we(dt,e=>a(q,e),()=>t(q));var ft=l(dt,2),Mt=o(ft,!0);i(ft);var u=l(ft,2);{var c=e=>{var n=Mn(),s=o(n),g=o(s,!0);i(s);var E=l(s,2);ne(E,3,()=>kt,M=>M,(M,N,pt,Ct)=>{var b=$n();let L;var B=o(b);i(b),lt(A=>{L=Ne(b,1,"radial-option svelte-furii8",null,L,{selected:t(d)===t(N),hovered:t(z)===t(N)}),de(b,A),nt(B,`${t(N)??""}%`)},[()=>(Tt(t(pt)),j(()=>`transform: ${Z(t(pt))}`))]),R("pointerenter",b,()=>a(z,t(N))),R("focus",b,()=>a(z,t(N))),R("pointerleave",b,()=>a(z,null)),R("blur",b,()=>a(z,null)),R("click",b,()=>Jt(t(N))),w(M,b)}),i(n),we(n,M=>a(W,M),()=>t(W)),Ie(n,M=>va?.(M)),lt(M=>{de(n,t(bt)),nt(g,M)},[()=>(t(z),t(d),j(()=>St(t(z)??t(d))))]),w(e,n)};wt(u,e=>{t(p)&&e(c)})}i(et),lt(()=>{fe(et,"data-state",t(U)),fe(et,"data-open",t(p)),dt.disabled=v(),nt(Vt,t(V)),nt(Mt,t(X))}),R("wheel",et,Ot),w(f,et),me()}var An=C('<button type="button"> </button>'),Rn=C('<div class="radial svelte-cojlv"><div class="radial-label svelte-cojlv"> </div> <!></div>'),Dn=C('<div class="picker svelte-cojlv"><button type="button" class="value-button svelte-cojlv" aria-label="Attendance probability"><span class="value-label svelte-cojlv"> </span></button> <p class="hint svelte-cojlv" aria-live="polite"> </p> <!></div>');function Pn(f,x){be(x,!1);const d=y(),U=y(),X=y(),V=y();let S=Kt(x,"value",8,null),v=Kt(x,"disabled",8,!1);const J=0,G=100,kt=Array.from({length:11},(e,n)=>n*10),jt=176,$t=62,At=kt.length,Z=120,Y=120,_t=250,zt=12,T="[data-result-pane]",K="reunion:radial-channel";function ot(e){const n=e/At*Math.PI*2-Math.PI/2,s=Math.cos(n)*$t,g=Math.sin(n)*$t;return`translate(calc(-50% + ${s}px), calc(-50% + ${g}px))`}const xt=ze();let p=y(!1),z=y(null),r=y(void 0),q=y(null),W=y(null),bt=y(""),st=!1,ct=0,_=y(null),$=null,O=!1,Et=0,Q=null;const St=e=>typeof e=="number"?`${e.toString().padStart(2,"0")}%`:"??%";function Gt(e){return xt("register",{element:e}),{destroy(){xt("unregister",{element:e})}}}function D(e){xt("commit",{value:e})}function qt(e){if(v())return;ht(!0);const n=typeof t(d)=="number"?t(d):0,s=Math.min(G,Math.max(J,n+e));a(r,s),D(s)}function Ot(e){if(v())return;const n=Math.abs(e.deltaY)+Math.abs(e.deltaX);if(t(p)){if(H(n))return;e.preventDefault();return}if(!O&&n>Y){O=!0,tt(!1);return}if(O)return;e.preventDefault();const s=e.ctrlKey?10:e.shiftKey?5:1;for(ct+=e.deltaY;ct<=-Z;)qt(s),ct+=Z;for(;ct>=Z;)qt(-s),ct-=Z}function Pt(e){if(v())return;const n=e.key.length===1&&e.key>="0"&&e.key<="9";switch(e.key){case"Enter":e.preventDefault(),e.stopPropagation(),t(_)!==null?vt():t(p)&&tt(!1),xt("advance",{direction:1});break;case"Tab":e.preventDefault(),e.stopPropagation(),t(p)&&tt(!1),xt("advance",{direction:e.shiftKey?-1:1});break;case" ":e.preventDefault(),e.stopPropagation(),tt(!0);break;case"Escape":t(p)?(e.preventDefault(),tt(!1)):t(_)!==null&&(e.preventDefault(),ht(!1));break;case"ArrowUp":case"ArrowRight":e.preventDefault(),e.stopPropagation(),qt(e.shiftKey?5:1);break;case"ArrowDown":case"ArrowLeft":e.preventDefault(),e.stopPropagation(),qt(e.shiftKey?-5:-1);break;case"Backspace":(t(_)!==null||typeof t(d)=="number"||t(d)===null)&&(e.preventDefault(),e.stopPropagation(),I());break;case"Delete":(t(_)!==null||typeof t(d)=="number"||t(d)===null)&&(e.preventDefault(),e.stopPropagation(),it());break;default:n&&(e.preventDefault(),e.stopPropagation(),k(e.key))}}function Yt(e){if(!t(p))return;const n=e.target;t(q)?.contains(n)||t(W)?.contains(n)||tt(!1)}function Bt(e){t(p)&&e.key==="Escape"&&(e.preventDefault(),tt(!1))}function Wt(e){if(!t(p))return;const n=Math.abs(e.deltaY)+Math.abs(e.deltaX);H(n)}function Xt(){st||(window.addEventListener("pointerdown",Yt,!0),window.addEventListener("keydown",Bt,!0),window.addEventListener("wheel",Wt,{passive:!0}),window.addEventListener("scroll",Ht,!0),window.addEventListener("resize",Ht,!0),st=!0)}function Ut(){st&&(window.removeEventListener("pointerdown",Yt,!0),window.removeEventListener("keydown",Bt,!0),window.removeEventListener("wheel",Wt),window.removeEventListener("scroll",Ht,!0),window.removeEventListener("resize",Ht,!0),st=!1)}async function Ht(){await yt()}async function yt(){if(!t(p)||!t(q)||(await Me(),!t(p)||!t(q)))return;const e=t(q).getBoundingClientRect(),n=jt,s=n/2;let g=e.top+e.height/2,E=e.left+e.width/2;const M=zt,N=Rt(),pt=window.innerHeight-N-zt,Ct=zt,b=window.innerWidth-zt,L=g-s,B=g+s,A=E-s,mt=E+s;let rt=0;L<M?rt=L-M:B>pt&&(rt=B-pt);let Lt=0;if(A<Ct?Lt=A-Ct:mt>b&&(Lt=mt-b),(Lt!==0||rt!==0)&&(window.scrollBy({top:rt,left:Lt,behavior:"auto"}),await Me(),!t(p)||!t(q)))return;const It=t(q).getBoundingClientRect();g=It.top+It.height/2,E=It.left+It.width/2;const Qt=zt+s,ie=window.innerHeight-N-zt-s,_e=zt+s,se=window.innerWidth-zt-s;g=Math.min(Math.max(g,Qt),ie),E=Math.min(Math.max(E,_e),se);const te=t(W)?.offsetParent instanceof HTMLElement?t(W).offsetParent.getBoundingClientRect():null,ee=te?.top??0,ce=te?.left??0,oe=g-ee,re=E-ce;a(bt,`top:${Math.round(oe)}px;left:${Math.round(re)}px;--overlay-size:${n}px;`)}function Rt(){const e=document.querySelector(T);if(!e)return 0;const n=e.getBoundingClientRect();if(n.top>=window.innerHeight)return 0;const s=Math.min(n.height,Math.max(0,window.innerHeight-Math.max(n.top,0)));return Math.max(0,s)}function tt(e){if(v())return;const n=e??!t(p);n!==t(p)&&(a(p,n),t(p)?(Dt(),O=!1,ut(),a(_,null),$=null,a(z,t(d)),a(r,void 0),ct=0,Xt(),yt()):(a(z,null),a(bt,""),Ut(),ut()))}function Jt(e){v()||(a(_,null),$=null,a(r,e),D(e),a(z,e),tt(!1))}Oe(()=>{Ut(),ut()}),Le(()=>{const e=n=>P(n);return window.addEventListener(K,e),()=>{window.removeEventListener(K,e)}});function h(){t(_)===null&&($=typeof t(d)=="number"?t(d):S()??null,typeof t(d)=="number"?a(_,t(d).toString()):typeof $=="number"?a(_,$.toString()):a(_,""))}function m(e){const n=e.replace(/\D/g,"").slice(0,3);if(n.length===0){a(_,""),a(r,null),D(null);return}const s=Number.parseInt(n,10),g=s>G?G:s;if(s>G&&n.length>0){a(_,String(Math.floor(s/10))),a(r,Number.parseInt(t(_),10)),D(t(r));return}a(_,g.toString()),a(r,g),D(g)}function k(e){h();const n=t(_)??"",s=n+e,g=Number.parseInt(s,10);!Number.isNaN(g)&&g>G&&n!==""||m(s)}function I(){h();const e=t(_)??"";if(e.length===0){a(_,""),a(r,null),D(null);return}m(e.slice(0,-1))}function it(){h(),a(_,""),a(r,null),D(null)}function vt(){t(_)!==null&&(a(_,null),$=null)}function ht(e){if(t(_)===null)return;const n=$;a(_,null),$=null,!e&&n!==S()?(a(r,n??null),D(n??null)):e||a(r,void 0)}function ut(){Et=0,Q&&(clearTimeout(Q),Q=null)}function H(e){return t(p)?(Et+=e,Q&&clearTimeout(Q),Q=window.setTimeout(()=>{Et=0,Q=null},_t),Et>=Y?(O||(O=!0),tt(!1),ut(),!0):!1):!1}function Dt(){if(typeof window>"u")return;const e={source:t(q)};window.dispatchEvent(new CustomEvent(K,{detail:e}))}function P(e){!t(p)||e.detail?.source===t(q)||tt(!1)}F(()=>(t(r),Tt(S())),()=>{t(r)!==void 0&&S()===t(r)&&a(r,void 0)}),F(()=>(t(r),Tt(S())),()=>{a(d,t(r)===void 0?S():t(r))}),F(()=>(Tt(v()),t(d)),()=>{a(U,v()?"disabled":t(d)===null?"empty":t(d)<J||t(d)>G?"invalid":"valid")}),F(()=>t(U),()=>{a(X,t(U)==="invalid"?"Keep between 0 and 100%.":"")}),F(()=>(t(_),t(d)),()=>{a(V,t(_)!==null?t(_)===""?"??%":`${t(_)}%`:St(t(d)))}),xe(),pe();var et=Dn(),dt=o(et),Nt=o(dt),Vt=o(Nt,!0);i(Nt),i(dt),ye(()=>R("click",dt,()=>tt())),ye(()=>R("keydown",dt,Pt)),ye(()=>R("auto-open",dt,()=>tt(!0))),Ie(dt,e=>Gt?.(e)),we(dt,e=>a(q,e),()=>t(q));var ft=l(dt,2),Mt=o(ft,!0);i(ft);var u=l(ft,2);{var c=e=>{var n=Rn(),s=o(n),g=o(s,!0);i(s);var E=l(s,2);ne(E,3,()=>kt,M=>M,(M,N,pt,Ct)=>{var b=An();let L;var B=o(b);i(b),lt(A=>{L=Ne(b,1,"radial-option svelte-cojlv",null,L,{selected:t(d)===t(N),hovered:t(z)===t(N)}),de(b,A),nt(B,`${t(N)??""}%`)},[()=>(Tt(t(pt)),j(()=>`transform: ${ot(t(pt))}`))]),R("pointerenter",b,()=>a(z,t(N))),R("focus",b,()=>a(z,t(N))),R("pointerleave",b,()=>a(z,null)),R("blur",b,()=>a(z,null)),R("click",b,()=>Jt(t(N))),w(M,b)}),i(n),we(n,M=>a(W,M),()=>t(W)),Ie(n,M=>va?.(M)),lt(M=>{de(n,t(bt)),nt(g,M)},[()=>(t(z),t(d),j(()=>St(t(z)??t(d))))]),w(e,n)};wt(u,e=>{t(p)&&e(c)})}i(et),lt(()=>{fe(et,"data-state",t(U)),fe(et,"data-open",t(p)),dt.disabled=v(),nt(Vt,t(V)),nt(Mt,t(X))}),R("wheel",et,Ot),w(f,et),me()}let De=null;const In='button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';function On(){if(typeof document>"u")return;const f=document.activeElement;f&&typeof f.focus=="function"&&(De=f)}function Nn(){if(De){try{De.focus({preventScroll:!0})}catch{}De=null}}function ca(f){if(!f)return;const x=f.querySelector(In);x&&x.focus({preventScroll:!0})}var Bn=C('<p class="empty svelte-1bwzqxo">No continents detected in this dataset.</p>'),Un=C("<option> </option>"),Hn=C('<div class="matrix-row svelte-1bwzqxo"><div class="matrix-cell continent-cell svelte-1bwzqxo"> </div> <div class="matrix-cell utility-cell svelte-1bwzqxo"><div class="control-row svelte-1bwzqxo"><label><span class="sr-only"> </span> <select class="svelte-1bwzqxo"></select></label> <button type="button" class="svelte-1bwzqxo">Apply</button></div> <div class="control-row svelte-1bwzqxo"><label class="delta-label svelte-1bwzqxo"><span class="sr-only"> </span> <select class="svelte-1bwzqxo"><option>‚Äî</option><option>-50</option><option>-25</option><option>-10</option><option>-5</option><option>+5</option><option>+10</option><option>+25</option><option>+50</option></select></label> <button type="button" class="svelte-1bwzqxo">Apply</button></div></div> <div class="matrix-cell probability-cell svelte-1bwzqxo"><div class="control-row svelte-1bwzqxo"><label><span class="sr-only"> </span> <select class="svelte-1bwzqxo"><option>‚Äî</option><option>0</option><option>25</option><option>50</option><option>75</option><option>100</option></select></label> <button type="button" class="svelte-1bwzqxo">Apply</button></div> <div class="control-row svelte-1bwzqxo"><label class="delta-label svelte-1bwzqxo"><span class="sr-only"> </span> <select class="svelte-1bwzqxo"><option>‚Äî</option><option>-50</option><option>-25</option><option>-10</option><option>-5</option><option>+5</option><option>+10</option><option>+25</option><option>+50</option></select></label> <button type="button" class="svelte-1bwzqxo">Apply</button></div></div></div>'),Vn=C('<div class="backdrop svelte-1bwzqxo" role="presentation" tabindex="-1"><div class="dialog svelte-1bwzqxo" role="dialog" aria-modal="true" aria-label="Bulk actions"><header class="svelte-1bwzqxo"><div><h2 class="svelte-1bwzqxo">Bulk Actions</h2> <p class="subtitle svelte-1bwzqxo">Trigger presets or continent tweaks without leaving the grid.</p></div> <button type="button" class="close svelte-1bwzqxo" aria-label="Close dialog">√ó</button></header> <div class="content svelte-1bwzqxo"><section class="global svelte-1bwzqxo"><h3 class="svelte-1bwzqxo">Global Overrides</h3> <div class="global-grid svelte-1bwzqxo"><fieldset class="svelte-1bwzqxo"><legend class="svelte-1bwzqxo">Probabilities</legend> <div class="button-column svelte-1bwzqxo"><button type="button" class="svelte-1bwzqxo">Set all to 100%</button> <button type="button" class="svelte-1bwzqxo">Set all to 50%</button> <button type="button" class="svelte-1bwzqxo">Set all to 0%</button></div> <div class="button-row svelte-1bwzqxo"><button type="button" class="svelte-1bwzqxo">+10 to all</button> <button type="button" class="svelte-1bwzqxo">‚àí10 to all</button></div> <div class="normalize svelte-1bwzqxo"><span>Normalize average to</span> <input type="number" min="0" max="100" step="1" aria-label="Target mean probability"/> <span>%</span> <button type="button" class="svelte-1bwzqxo">Normalize</button></div></fieldset> <fieldset class="svelte-1bwzqxo"><legend class="svelte-1bwzqxo">Utilities</legend> <div class="button-column svelte-1bwzqxo"><button type="button" class="svelte-1bwzqxo">Set all utilities to 50</button></div> <div class="button-row svelte-1bwzqxo"><button type="button" class="svelte-1bwzqxo">+10 to all</button> <button type="button" class="svelte-1bwzqxo">‚àí10 to all</button></div></fieldset></div></section> <section class="matrix svelte-1bwzqxo"><header class="matrix-head svelte-1bwzqxo"><h3 class="svelte-1bwzqxo">Per-Continent Adjustments</h3> <p class="svelte-1bwzqxo">Set specific baselines or deltas for each region.</p></header> <div class="matrix-table svelte-1bwzqxo"><div class="matrix-row matrix-header svelte-1bwzqxo"><div class="matrix-cell continent-cell svelte-1bwzqxo">Continent</div> <div class="matrix-cell utility-cell svelte-1bwzqxo"><div>Favorability</div> <div class="cell-sub svelte-1bwzqxo">Set to / Adjust by</div></div> <div class="matrix-cell probability-cell svelte-1bwzqxo"><div>Probability</div> <div class="cell-sub svelte-1bwzqxo">Set to / Adjust by</div></div></div> <!></div></section></div> <footer class="actions svelte-1bwzqxo"><button type="button" class="secondary svelte-1bwzqxo">Close</button></footer></div></div>');function Fn(f,x){be(x,!1);let d=Kt(x,"open",8,!1),U=Kt(x,"continents",24,()=>[]);const X=ze();let V=y(null),S=y(!1),v=y([]),J=y(50);const G=["","0","25","50","75","100"];function kt(p){return{continent:p,utilitySet:"",utilityDelta:"",probabilitySet:"",probabilityDelta:""}}function jt(p=!1){const z=new Map(t(v).map(r=>[r.continent,r]));a(v,U().map(r=>!p&&z.has(r)?{...z.get(r)}:kt(r))),U().length===0&&a(v,[])}function $t(){a(J,50),jt(!0)}function At(){X("cancel")}function Z(p,z=0,r=100){return Math.max(z,Math.min(r,Math.round(p)))}function Y(p){if(p.trim()==="")return null;const z=Number(p);return Number.isFinite(z)?z:null}function _t(p){const z=Array.isArray(p)?p:[p];X("apply",{actions:z})}function zt(p){const z=p.currentTarget,r=p.target;r&&z.contains(r)&&r!==z||At()}function T(p){p.key==="Escape"&&(p.preventDefault(),At())}F(()=>Tt(d()),()=>{a(S,d())}),F(()=>(Tt(d()),t(S)),()=>{d()&&!t(S)&&$t()}),F(()=>(Tt(d()),t(V),ca),()=>{d()&&t(V)&&ca(t(V))}),F(()=>Tt(d()),()=>{d()&&jt(!1)}),xe(),pe();var K=ae(),ot=Zt(K);{var xt=p=>{var z=Vn(),r=o(z),q=o(r),W=l(o(q),2);i(q);var bt=l(q,2),st=o(bt),ct=l(o(st),2),_=o(ct),$=l(o(_),2),O=o($),Et=l(O,2),Q=l(Et,2);i($);var St=l($,2),Gt=o(St),D=l(Gt,2);i(St);var qt=l(St,2),Ot=l(o(qt),2);xa(Ot);var Pt=l(Ot,4);i(qt),i(_);var Yt=l(_,2),Bt=l(o(Yt),2),Wt=o(Bt);i(Bt);var Xt=l(Bt,2),Ut=o(Xt),Ht=l(Ut,2);i(Xt),i(Yt),i(ct),i(st);var yt=l(st,2),Rt=l(o(yt),2),tt=l(o(Rt),2);{var Jt=I=>{var it=Bn();w(I,it)},h=I=>{var it=ae(),vt=Zt(it);ne(vt,3,()=>t(v),ht=>ht.continent,(ht,ut,H)=>{var Dt=Hn(),P=o(Dt),et=o(P,!0);i(P);var dt=l(P,2),Nt=o(dt),Vt=o(Nt),ft=o(Vt),Mt=o(ft);i(ft);var u=l(ft,2);lt(()=>{t(v),Ae(()=>{t(H)})}),ne(u,5,()=>G,gt=>gt,(gt,Ee)=>{var qe=Un(),pa=o(qe,!0);i(qe);var oa={};lt(()=>{nt(pa,t(Ee)===""?"‚Äî":t(Ee)),oa!==(oa=t(Ee))&&(qe.value=(qe.__value=t(Ee))??"")}),w(gt,qe)}),i(u),i(Vt);var c=l(Vt,2);i(Nt);var e=l(Nt,2),n=o(e),s=o(n),g=o(s);i(s);var E=l(s,2);lt(()=>{t(v),Ae(()=>{t(H)})});var M=o(E);M.value=M.__value="";var N=l(M);N.value=N.__value="-50";var pt=l(N);pt.value=pt.__value="-25";var Ct=l(pt);Ct.value=Ct.__value="-10";var b=l(Ct);b.value=b.__value="-5";var L=l(b);L.value=L.__value="+5";var B=l(L);B.value=B.__value="+10";var A=l(B);A.value=A.__value="+25";var mt=l(A);mt.value=mt.__value="+50",i(E),i(n);var rt=l(n,2);i(e),i(dt);var Lt=l(dt,2),It=o(Lt),Qt=o(It),ie=o(Qt),_e=o(ie);i(ie);var se=l(ie,2);lt(()=>{t(v),Ae(()=>{t(H)})});var te=o(se);te.value=te.__value="";var ee=l(te);ee.value=ee.__value="0";var ce=l(ee);ce.value=ce.__value="25";var oe=l(ce);oe.value=oe.__value="50";var re=l(oe);re.value=re.__value="75";var ke=l(re);ke.value=ke.__value="100",i(se),i(Qt);var je=l(Qt,2);i(It);var Te=l(It,2),at=o(Te),Ft=o(at),he=o(Ft);i(Ft);var ge=l(Ft,2);lt(()=>{t(v),Ae(()=>{t(H)})});var Be=o(ge);Be.value=Be.__value="";var Ue=l(Be);Ue.value=Ue.__value="-50";var He=l(Ue);He.value=He.__value="-25";var Ve=l(He);Ve.value=Ve.__value="-10";var Fe=l(Ve);Fe.value=Fe.__value="-5";var Ke=l(Fe);Ke.value=Ke.__value="+5";var Ge=l(Ke);Ge.value=Ge.__value="+10";var Ye=l(Ge);Ye.value=Ye.__value="+25";var na=l(Ye);na.value=na.__value="+50",i(ge),i(at);var ia=l(at,2);i(Te),i(Lt),i(Dt),lt((gt,Ee)=>{nt(et,(t(ut),j(()=>t(ut).continent))),nt(Mt,`Set favorability for ${t(ut),j(()=>t(ut).continent)??""}`),c.disabled=(t(v),Tt(t(H)),j(()=>t(v)[t(H)].utilitySet==="")),nt(g,`Adjust favorability by for ${t(ut),j(()=>t(ut).continent)??""}`),rt.disabled=gt,nt(_e,`Set probability for ${t(ut),j(()=>t(ut).continent)??""}`),je.disabled=(t(v),Tt(t(H)),j(()=>t(v)[t(H)].probabilitySet==="")),nt(he,`Adjust probability by for ${t(ut),j(()=>t(ut).continent)??""}`),ia.disabled=Ee},[()=>(t(v),Tt(t(H)),j(()=>Y(t(v)[t(H)].utilityDelta)===null)),()=>(t(v),Tt(t(H)),j(()=>Y(t(v)[t(H)].probabilityDelta)===null))]),Re(u,()=>t(v)[t(H)].utilitySet,gt=>Se(v,t(v)[t(H)].utilitySet=gt)),R("click",c,()=>{const gt=Y(t(v)[t(H)].utilitySet);gt!==null&&_t({type:"setContinentUtility",continent:t(ut).continent,value:Z(gt)})}),Re(E,()=>t(v)[t(H)].utilityDelta,gt=>Se(v,t(v)[t(H)].utilityDelta=gt)),R("click",rt,()=>{const gt=Y(t(v)[t(H)].utilityDelta);gt===null||gt===0||(Se(v,t(v)[t(H)].utilityDelta=gt>0?`+${gt}`:`${gt}`),_t({type:"adjustContinentUtility",continent:t(ut).continent,delta:Math.round(gt)}))}),Re(se,()=>t(v)[t(H)].probabilitySet,gt=>Se(v,t(v)[t(H)].probabilitySet=gt)),R("click",je,()=>{const gt=Y(t(v)[t(H)].probabilitySet);gt!==null&&_t({type:"setContinentProbability",continent:t(ut).continent,value:Z(gt)})}),Re(ge,()=>t(v)[t(H)].probabilityDelta,gt=>Se(v,t(v)[t(H)].probabilityDelta=gt)),R("click",ia,()=>{const gt=Y(t(v)[t(H)].probabilityDelta);gt===null||gt===0||(Se(v,t(v)[t(H)].probabilityDelta=gt>0?`+${gt}`:`${gt}`),_t({type:"adjustContinentProbability",continent:t(ut).continent,delta:Math.round(gt)}))}),w(ht,Dt)}),w(I,it)};wt(tt,I=>{t(v),j(()=>t(v).length===0)?I(Jt):I(h,!1)})}i(Rt),i(yt),i(bt);var m=l(bt,2),k=o(m);i(m),i(r),we(r,I=>a(V,I),()=>t(V)),i(z),R("click",W,At),R("click",O,()=>_t({type:"setAllProbabilities",value:100})),R("click",Et,()=>_t({type:"setAllProbabilities",value:50})),R("click",Q,()=>_t({type:"setAllProbabilities",value:0})),R("click",Gt,()=>_t({type:"adjustAllProbabilities",delta:10})),R("click",D,()=>_t({type:"adjustAllProbabilities",delta:-10})),Cn(Ot,()=>t(J),I=>a(J,I)),R("click",Pt,()=>{Number.isFinite(t(J))&&_t({type:"normalizeProbabilities",target:Z(Number(t(J)))})}),R("click",Wt,()=>_t({type:"setAllUtilities",value:50})),R("click",Ut,()=>_t({type:"adjustAllUtilities",delta:10})),R("click",Ht,()=>_t({type:"adjustAllUtilities",delta:-10})),R("click",k,At),R("click",z,zt),R("keydown",z,T),w(p,z)};wt(ot,p=>{d()&&p(xt)})}w(f,K),me()}var Kn=C('<p class="empty svelte-h2c6bt">No commands yet.</p>'),Gn=C('<li class="svelte-h2c6bt"> </li>'),Yn=C('<ul class="diffs svelte-h2c6bt"></ul>'),Wn=C('<p class="empty svelte-h2c6bt">No displayed changes</p>'),Xn=C('<li class="svelte-h2c6bt"><div class="row-head svelte-h2c6bt"><strong> </strong> <span class="meta svelte-h2c6bt"> </span></div> <!></li>'),Jn=C('<ul class="svelte-h2c6bt"></ul>'),Zn=C('<p class="empty svelte-h2c6bt">Nothing queued.</p>'),Qn=C('<li class="svelte-h2c6bt"> </li>'),ti=C('<ul class="diffs svelte-h2c6bt"></ul>'),ei=C('<p class="empty svelte-h2c6bt">No displayed changes</p>'),ai=C('<li class="svelte-h2c6bt"><div class="row-head svelte-h2c6bt"><strong> </strong> <span class="meta svelte-h2c6bt"> </span></div> <!></li>'),ni=C('<ul class="svelte-h2c6bt"></ul>'),ii=C('<div class="history-overlay svelte-h2c6bt" role="dialog" aria-label="Command history"><section class="svelte-h2c6bt"><header class="svelte-h2c6bt">Past</header> <!></section> <section class="svelte-h2c6bt"><header class="svelte-h2c6bt">Future</header> <!></section></div>'),oi=C('<div class="history-wrapper svelte-h2c6bt" role="group"><button type="button" class="history-button svelte-h2c6bt" aria-haspopup="dialog"><span class="btn-icon svelte-h2c6bt" aria-hidden="true">üßæ</span> <span> </span></button> <!></div>');function ri(f,x){be(x,!1);const d=()=>ue(le,"$commandHistoryStore",X),U=()=>ue(da,"$citiesStore",X),[X,V]=ta();let S=y(!1),v=y(null),J=y({past:[],future:[]}),G=y([]),kt=y([]),jt=y([]),$t=y({});function At(){a(S,!0)}function Z(r){r instanceof FocusEvent&&r.currentTarget instanceof HTMLElement&&r.relatedTarget instanceof HTMLElement&&r.currentTarget.contains(r.relatedTarget)||a(S,!1)}function Y(r,q=!1){return r==null?"??":q?`${r}%`:`${r}`}function _t(r,q){if(!r&&!q)return[];const W=r?.entries??{},bt=q?.entries??{},st=new Set([...Object.keys(W),...Object.keys(bt)]),ct=[];for(const _ of st){const $=W[_]??null,O=bt[_]??null,Et=t($t)[_]?.name??_;if(!$&&O){O.utility!==null&&ct.push(`${Et} utility ${Y(null)} ‚Üí ${Y(O.utility)}`),O.probability!==null&&ct.push(`${Et} probability ${Y(null,!0)} ‚Üí ${Y(O.probability,!0)}`);continue}$&&O&&($.utility!==O.utility&&ct.push(`${Et} utility ${Y($.utility)} ‚Üí ${Y(O.utility)}`),$.probability!==O.probability&&ct.push(`${Et} probability ${Y($.probability,!0)} ‚Üí ${Y(O.probability,!0)}`)),$&&!O&&($.utility!==null&&ct.push(`${Et} utility ${Y($.utility)} ‚Üí ${Y(null)}`),$.probability!==null&&ct.push(`${Et} probability ${Y($.probability,!0)} ‚Üí ${Y(null,!0)}`))}return ct}function zt(r,q){return _t(r,q)}F(()=>d(),()=>{a(J,d())}),F(()=>t(J),()=>{a(G,[...t(J).past??[]].slice().reverse())}),F(()=>t(J),()=>{a(kt,t(J).future??[])}),F(()=>U(),()=>{a(jt,U()??[])}),F(()=>t(jt),()=>{a($t,Object.fromEntries(t(jt).map(r=>[r.id,r])))}),xe(),pe();var T=oi(),K=o(T),ot=l(o(K),2),xt=o(ot);i(ot),i(K),we(K,r=>a(v,r),()=>t(v));var p=l(K,2);{var z=r=>{var q=ii(),W=o(q),bt=l(o(W),2);{var st=Q=>{var St=Kn();w(Q,St)},ct=Q=>{var St=Jn();ne(St,5,()=>t(G),Ze,(Gt,D)=>{var qt=Xn(),Ot=o(qt),Pt=o(Ot),Yt=o(Pt,!0);i(Pt);var Bt=l(Pt,2),Wt=o(Bt);i(Bt),i(Ot);var Xt=l(Ot,2);{var Ut=yt=>{var Rt=Yn();ne(Rt,5,()=>(t(D),j(()=>zt(t(D).before?.vote,t(D).after?.vote))),tt=>tt,(tt,Jt)=>{var h=Gn(),m=o(h,!0);i(h),lt(()=>nt(m,t(Jt))),w(tt,h)}),i(Rt),w(yt,Rt)},Ht=yt=>{var Rt=Wn();w(yt,Rt)};wt(Xt,yt=>{t(D),j(()=>zt(t(D).before?.vote,t(D).after?.vote).length)?yt(Ut):yt(Ht,!1)})}i(qt),lt(yt=>{nt(Yt,(t(D),j(()=>t(D).label))),nt(Wt,`[${yt??""}]`)},[()=>(t(D),j(()=>t(D).scope.join(", ")))]),w(Gt,qt)}),i(St),w(Q,St)};wt(bt,Q=>{t(G),j(()=>t(G).length===0)?Q(st):Q(ct,!1)})}i(W);var _=l(W,2),$=l(o(_),2);{var O=Q=>{var St=Zn();w(Q,St)},Et=Q=>{var St=ni();ne(St,5,()=>t(kt),Ze,(Gt,D)=>{var qt=ai(),Ot=o(qt),Pt=o(Ot),Yt=o(Pt,!0);i(Pt);var Bt=l(Pt,2),Wt=o(Bt);i(Bt),i(Ot);var Xt=l(Ot,2);{var Ut=yt=>{var Rt=ti();ne(Rt,5,()=>(t(D),j(()=>zt(t(D).before?.vote,t(D).after?.vote))),tt=>tt,(tt,Jt)=>{var h=Qn(),m=o(h,!0);i(h),lt(()=>nt(m,t(Jt))),w(tt,h)}),i(Rt),w(yt,Rt)},Ht=yt=>{var Rt=ei();w(yt,Rt)};wt(Xt,yt=>{t(D),j(()=>zt(t(D).before?.vote,t(D).after?.vote).length)?yt(Ut):yt(Ht,!1)})}i(qt),lt(yt=>{nt(Yt,(t(D),j(()=>t(D).label))),nt(Wt,`[${yt??""}]`)},[()=>(t(D),j(()=>t(D).scope.join(", ")))]),w(Gt,qt)}),i(St),w(Q,St)};wt($,Q=>{t(kt),j(()=>t(kt).length===0)?Q(O):Q(Et,!1)})}i(_),i(q),w(r,q)};wt(p,r=>{t(S)&&r(z)})}i(T),lt(()=>{fe(K,"aria-expanded",t(S)),nt(xt,`Log (${t(J),j(()=>t(J).past.length)??""})`)}),R("mouseenter",T,At),R("mouseleave",T,Z),R("focusin",T,At),R("focusout",T,Z),w(f,T),me(),V()}var li=C("<img/>");function ua(f,x){const d=ra(x,["children","$$slots","$$events","$$legacy"]),U=ra(d,["src","alt","loading","decoding"]);let X=Kt(x,"src",8),V=Kt(x,"alt",8),S=Kt(x,"loading",8,"lazy"),v=Kt(x,"decoding",8,"async");var J=li();Ea(J,()=>({...U,src:X(),alt:V(),loading:S(),decoding:v()})),ba(J),w(f,J)}var si=C('<p class="status svelte-f9uau2">Loading imagery‚Ä¶</p>'),ci=C('<p class="status error svelte-f9uau2"> </p>'),ui=C('<figure class="inline-frame svelte-f9uau2"><!></figure>'),di=C('<p class="inline-weather svelte-f9uau2"> </p>'),vi=C('<p class="inline-food svelte-f9uau2"> </p>'),fi=C('<div class="inline-track svelte-f9uau2"></div> <div class="inline-overlay svelte-f9uau2"><div class="inline-heading svelte-f9uau2"><span class="inline-name svelte-f9uau2"> </span> <span class="inline-country svelte-f9uau2"> </span></div> <p class="inline-summary svelte-f9uau2"> </p> <!> <!></div>',1),pi=C('<p class="status muted svelte-f9uau2">Images coming soon.</p>'),bi=C('<div class="inline-strip svelte-f9uau2" role="group"><!></div>'),mi=C('<div class="background-placeholder svelte-f9uau2">Loading imagery‚Ä¶</div>'),_i=C('<div class="background-placeholder svelte-f9uau2"> </div>'),hi=C('<div><div class="sprite-frame svelte-f9uau2"></div> <div class="sprite-frame svelte-f9uau2"></div></div>'),gi=C('<div class="background-placeholder svelte-f9uau2">Preparing imagery‚Ä¶</div>'),yi=C('<div class="background-strip svelte-f9uau2" aria-hidden="true"><!></div>'),wi=C('<p class="status svelte-f9uau2">Loading imagery‚Ä¶</p>'),xi=C('<p class="status error svelte-f9uau2"> </p>'),Ei=C('<span class="credit svelte-f9uau2"> </span>'),Si=C('<figcaption class="svelte-f9uau2"> <!></figcaption>'),zi=C('<figure class="svelte-f9uau2"><!> <!></figure>'),ki=C('<div class="image-row svelte-f9uau2"></div>'),ji=C('<p class="status muted svelte-f9uau2">Images coming soon.</p>'),qi=C('<div class="image-strip svelte-f9uau2" role="group"><!></div>');function Ci(f,x){be(x,!1);const d=y(),U=y(),X=y(),V=y();let S=Kt(x,"city",8),v=Kt(x,"variant",8,"details"),J=Kt(x,"direction",8,"normal"),G=Kt(x,"showCaptions",8,!0),kt=Kt(x,"scrollDuration",8,24);const jt=Object.create(null),$t=Object.create(null),At=Object.create(null),Z=480,Y="Details available in the expanded view.",_t=1,zt={};let T=y("idle"),K=y(null),ot=y([]),xt=y([]),p=y(""),z=null,r=0,q=y({}),W=y([]),bt=y(null),st=y(1),ct=y(1),_=0,$="";function O(h){let m=0;for(let k=0;k<h.length;k+=1)m=(m<<5)-m+h.charCodeAt(k),m|=0;return m}function Et(h){const m=kt()*2.5,k=h?.id;if(!k)return m;const vt=.5+Math.abs(O(k))%1e3/1e3*_t;return m*vt}function Q(h){const m=h.startsWith("/")?h:`/${h}`;return la?`${la}${m}`:m}function St(h){return Q(`${S().images_path}/${h}`)}async function Gt(h){if(!h)return;const m=++r;if(jt[h]){a(K,jt[h]),a(ot,t(K)?.images??[]),a(T,"ready"),a(p,""),typeof window<"u"&&Pt(t(ot));return}a(p,""),a(T,"loading");try{const k=await Sa(h);if(m!==r)return;jt[h]=k,a(K,k),a(ot,k.images??[]),a(T,"ready"),typeof window<"u"&&Pt(t(ot))}catch(k){if(m!==r)return;a(T,"error"),a(p,k instanceof Error?k.message:"Unable to load images.")}}function D(h){const m=h?.id??null;if(!m){z!==null&&(z=null,a(K,null),a(ot,[]),a(xt,[]),a(T,"idle"),a(p,""));return}if(m===z)return;z=m;const k=jt[m];if(k){a(K,k),a(ot,k.images??[]),a(T,"ready"),a(p,""),qt(),typeof window<"u"&&Pt(t(ot));return}a(K,null),a(ot,[]),a(xt,[]),a(T,"loading"),a(p,""),Gt(m).then(qt)}function qt(){const h=t(ot)??[],m=h.length>1?Xt(z,h):h;(v()==="inline"||v()==="background")&&m.length>0?a(xt,[...m,...m]):a(xt,m)}function Ot(h){if(!h)return 1;const m=t(q)[h]??$t[h];return m&&Number.isFinite(m)&&m>0?m:1}async function Pt(h){const m=h.filter(k=>k.image&&!$t[k.image]);m.length!==0&&(await Promise.all(m.map(k=>new Promise(I=>{const it=new Image;it.src=St(k.image),it.onload=()=>{const vt=it.naturalHeight?it.naturalWidth/it.naturalHeight:1;$t[k.image]=vt>0?vt:1,I()},it.onerror=()=>{$t[k.image]=1,I()}}))),a(q,Object.fromEntries(Object.entries($t).map(([k,I])=>[k,I&&Number.isFinite(I)&&I>0?I:1]))))}function Yt(h){const m=At[h];return m&&m.complete&&m.naturalWidth>0?Promise.resolve(m):new Promise((k,I)=>{const it=new Image;it.crossOrigin="anonymous",it.decoding="async",it.onload=()=>{At[h]=it,k(it)},it.onerror=()=>{I(new Error(`Unable to load image at ${h}`))},it.src=h})}async function Bt(h){const m=h.filter(P=>!!P.image);if(m.length===0)throw new Error("No image sources available for sprite generation.");const k=await Promise.all(m.map(P=>Yt(St(P.image)))),I=Z,it=k.map(P=>P.naturalHeight?P.naturalWidth/P.naturalHeight*I:I),vt=Math.max(1,Math.round(it.reduce((P,et)=>P+et,0))),ht=document.createElement("canvas");ht.width=vt,ht.height=I;const ut=ht.getContext("2d");if(!ut)throw new Error("Unable to obtain canvas rendering context.");let H=0;for(let P=0;P<k.length;P+=1){const et=k[P],dt=it[P];ut.drawImage(et,H,0,dt,I),H+=dt}let Dt="";try{Dt=ht.toDataURL("image/webp",.92)}catch{Dt=""}return(!Dt||Dt==="data:,")&&(Dt=ht.toDataURL("image/png")),{url:Dt,ratio:vt/I}}function Wt(h){const m=[...h];for(let k=m.length-1;k>0;k-=1){const I=Math.floor(Math.random()*(k+1));[m[k],m[I]]=[m[I],m[k]]}return m}function Xt(h,m){if(!h)return Wt(m);const k=zt[h];if(k&&k.length===m.length)return k;const I=Wt(m);return zt[h]=I,I}function Ut(){a(bt,null),a(st,1),$=""}async function Ht(h){if(typeof window>"u"||v()!=="background")return;const m=h.length>1?Xt(z,h):h,k=m.map(it=>it.image??"").join("|");if(k&&k===$&&t(bt))return;if(!m.length){Ut();return}const I=++_;try{const{url:it,ratio:vt}=await Bt(m);if(I!==_)return;a(bt,it),a(st,Number.isFinite(vt)&&vt>0?vt:1),$=k}catch(it){if(I!==_)return;Ut(),console.warn("CityImageStrip: failed to build sprite",it)}}ma(()=>D(S())),Le(()=>{D(S()),typeof window<"u"&&t(ot).length&&Pt(t(ot))}),F(()=>{},()=>{qt()}),F(()=>t(K),()=>{a(d,t(K)?.summary??"")}),F(()=>t(K),()=>{a(U,t(K)?.seasonal_notes??"")}),F(()=>t(K),()=>{a(X,t(K)?.food_and_drink?.[0]??"")}),F(()=>Tt(S()),()=>{a(V,Et(S()))}),F(()=>(t(xt),t(q)),()=>{a(W,t(xt).map(h=>(t(q),Ot(h.image))))}),F(()=>t(st),()=>{a(ct,Number.isFinite(t(st))&&t(st)>0?t(st):1)}),F(()=>(Tt(v()),t(T),t(ot)),()=>{typeof window<"u"&&v()==="background"&&(t(T)==="ready"?Ht(t(ot)):Ut())}),xe(),pe();var yt=ae(),Rt=Zt(yt);{var tt=h=>{var m=bi(),k=o(m);{var I=vt=>{var ht=si();w(vt,ht)},it=vt=>{var ht=ae(),ut=Zt(ht);{var H=P=>{var et=ci(),dt=o(et,!0);i(et),lt(()=>nt(dt,t(p))),w(P,et)},Dt=P=>{var et=ae(),dt=Zt(et);{var Nt=ft=>{var Mt=fi(),u=Zt(Mt);ne(u,5,()=>t(xt),Ze,(B,A,mt)=>{var rt=ui(),Lt=o(rt);{let It=$e(()=>(t(A),j(()=>St(t(A).image)))),Qt=$e(()=>(t(A),Tt(S()),j(()=>t(A).caption??`${S().name} skyline`)));ua(Lt,{get src(){return t(It)},get alt(){return t(Qt)},loading:"lazy",decoding:"async"})}i(rt),lt(()=>{fe(rt,"aria-hidden",(t(ot),j(()=>mt>=t(ot).length?"true":void 0))),de(rt,(t(W),j(()=>`aspect-ratio: ${t(W)[mt]??1}`)))}),w(B,rt)}),i(u);var c=l(u,2),e=o(c),n=o(e),s=o(n,!0);i(n);var g=l(n,2),E=o(g,!0);i(g),i(e);var M=l(e,2),N=o(M,!0);i(M);var pt=l(M,2);{var Ct=B=>{var A=di(),mt=o(A,!0);i(A),lt(()=>nt(mt,t(U))),w(B,A)};wt(pt,B=>{t(U)&&B(Ct)})}var b=l(pt,2);{var L=B=>{var A=vi(),mt=o(A,!0);i(A),lt(()=>nt(mt,t(X))),w(B,A)};wt(b,B=>{t(X)&&B(L)})}i(c),lt(()=>{de(u,`--scroll-duration: ${t(V)}s; --scroll-direction: ${J()}`),nt(s,(Tt(S()),j(()=>S().name))),nt(E,(Tt(S()),j(()=>S().country))),nt(N,t(d)||Y)}),w(ft,Mt)},Vt=ft=>{var Mt=pi();w(ft,Mt)};wt(dt,ft=>{t(xt),j(()=>t(xt).length)?ft(Nt):ft(Vt,!1)},!0)}w(P,et)};wt(ut,P=>{t(T)==="error"?P(H):P(Dt,!1)},!0)}w(vt,ht)};wt(k,vt=>{t(T)==="loading"?vt(I):vt(it,!1)})}i(m),lt(()=>fe(m,"aria-label",(Tt(S()),j(()=>`Images for ${S().name}`)))),w(h,m)},Jt=h=>{var m=ae(),k=Zt(m);{var I=vt=>{var ht=yi(),ut=o(ht);{var H=P=>{var et=mi();w(P,et)},Dt=P=>{var et=ae(),dt=Zt(et);{var Nt=ft=>{var Mt=_i(),u=o(Mt,!0);i(Mt),lt(()=>nt(u,t(p))),w(ft,Mt)},Vt=ft=>{var Mt=ae(),u=Zt(Mt);{var c=n=>{var s=hi();let g;var E=o(s);let M;var N=l(E,2);let pt;i(s),lt(()=>{g=Ne(s,1,"sprite-runner svelte-f9uau2",null,g,{paused:!t(bt)}),de(s,`--scroll-duration: ${t(V)}s; --scroll-direction: ${J()==="reverse"?"reverse":"normal"};`),M=de(E,`--sprite-ratio: ${t(ct)};`,M,{"background-image":`url("${t(bt)}")`}),pt=de(N,`--sprite-ratio: ${t(ct)};`,pt,{"background-image":`url("${t(bt)}")`})}),w(n,s)},e=n=>{var s=gi();w(n,s)};wt(u,n=>{t(bt)?n(c):n(e,!1)},!0)}w(ft,Mt)};wt(dt,ft=>{t(T)==="error"?ft(Nt):ft(Vt,!1)},!0)}w(P,et)};wt(ut,P=>{t(T)==="loading"?P(H):P(Dt,!1)})}i(ht),w(vt,ht)},it=vt=>{var ht=qi(),ut=o(ht);{var H=P=>{var et=wi();w(P,et)},Dt=P=>{var et=ae(),dt=Zt(et);{var Nt=ft=>{var Mt=xi(),u=o(Mt,!0);i(Mt),lt(()=>nt(u,t(p))),w(ft,Mt)},Vt=ft=>{var Mt=ae(),u=Zt(Mt);{var c=n=>{var s=ki();ne(s,5,()=>t(ot),g=>g.image,(g,E)=>{var M=zi(),N=o(M);{let b=$e(()=>(t(E),j(()=>St(t(E).image)))),L=$e(()=>(t(E),Tt(S()),j(()=>t(E).caption??`${S().name} skyline`)));ua(N,{get src(){return t(b)},get alt(){return t(L)},loading:"lazy",decoding:"async"})}var pt=l(N,2);{var Ct=b=>{var L=Si(),B=o(L),A=l(B);{var mt=rt=>{var Lt=Ei(),It=o(Lt);i(Lt),lt(()=>nt(It,`¬∑ ${t(E),j(()=>t(E).credit)??""}`)),w(rt,Lt)};wt(A,rt=>{t(E),j(()=>t(E).credit)&&rt(mt)})}i(L),lt(()=>nt(B,`${t(E),j(()=>t(E).caption)??""} `)),w(b,L)};wt(pt,b=>{Tt(G()),t(E),j(()=>G()&&t(E).caption)&&b(Ct)})}i(M),w(g,M)}),i(s),w(n,s)},e=n=>{var s=ji();w(n,s)};wt(u,n=>{t(ot),j(()=>t(ot).length)?n(c):n(e,!1)},!0)}w(ft,Mt)};wt(dt,ft=>{t(T)==="error"?ft(Nt):ft(Vt,!1)},!0)}w(P,et)};wt(ut,P=>{t(T)==="loading"?P(H):P(Dt,!1)})}i(ht),lt(()=>fe(ht,"aria-label",(Tt(S()),j(()=>`Images for ${S().name}`)))),w(vt,ht)};wt(k,vt=>{v()==="background"?vt(I):vt(it,!1)},!0)}w(h,m)};wt(Rt,h=>{v()==="inline"?h(tt):h(Jt,!1)})}w(f,yt),me()}var $i=C('<span class="chip svelte-jdafhq"><span class="label svelte-jdafhq">Country</span> <strong class="svelte-jdafhq"> </strong></span>'),Mi=C('<span class="chip status-chip svelte-jdafhq" role="status"><span class="label svelte-jdafhq">Status</span> <strong class="svelte-jdafhq">Session cleared.</strong></span>'),Li=C('<div class="confirm-backdrop svelte-jdafhq" role="presentation"><div class="confirm-box svelte-jdafhq" role="dialog" aria-modal="true" aria-labelledby="reset-heading"><h3 id="reset-heading" class="svelte-jdafhq">Clear all saved data?</h3> <p class="svelte-jdafhq">This removes your ballot inputs and undo history from this device. You cannot undo this action.</p> <div class="confirm-actions svelte-jdafhq"><button type="button" class="danger svelte-jdafhq">Yes, clear everything</button> <button type="button" class="svelte-jdafhq">Cancel</button></div></div></div>'),Ti=C('<div><!> <span class="chip chip-button static svelte-jdafhq"><span class="label svelte-jdafhq">Last saved</span> <span class="chip-content svelte-jdafhq"><span class="chip-icon svelte-jdafhq" aria-hidden="true">üíæ</span> <strong class="svelte-jdafhq"> </strong></span></span> <button type="button" class="chip chip-button svelte-jdafhq"><span class="label svelte-jdafhq"><span class="btn-icon svelte-jdafhq" aria-hidden="true">üóë</span> Reset</span> <strong class="svelte-jdafhq">Clear ballot</strong></button> <!></div> <!>',1);function Ai(f,x){be(x,!1);const d=()=>ue(Pe,"$settingsStore",X),U=()=>ue(ve,"$voteSessionStore",X),[X,V]=ta(),S=y();let v=Kt(x,"inline",8,!1);const J=ze();let G=y(!1),kt=y(!1),jt=null,$t=y(),At=y();function Z(){a(G,!0)}function Y(){a(G,!1)}function _t(){ve.clear(),ka.reset(),le.clear(),Pe.update($=>({...$,preferredMode:null})),a(kt,!0),Y(),jt&&clearTimeout(jt),jt=setTimeout(()=>{a(kt,!1)},3500),J("cleared")}Oe(()=>{jt&&clearTimeout(jt)});const zt=v()?"status-inline":"status-ribbon";F(()=>d(),()=>{a($t,d())}),F(()=>U(),()=>{a(At,U())}),F(()=>t(At),()=>{a(S,t(At).lastUpdated?new Date(t(At).lastUpdated).toLocaleTimeString():"Not saved yet")}),xe(),pe();var T=Ti(),K=Zt(T),ot=o(K);{var xt=$=>{var O=$i(),Et=l(o(O),2),Q=o(Et,!0);i(Et),i(O),lt(()=>nt(Q,(t($t),j(()=>t($t).countryKey)))),w($,O)};wt(ot,$=>{t($t),j(()=>t($t).countryKey)&&$(xt)})}var p=l(ot,2),z=l(o(p),2),r=l(o(z),2),q=o(r,!0);i(r),i(z),i(p);var W=l(p,2),bt=l(W,2);{var st=$=>{var O=Mi();w($,O)};wt(bt,$=>{t(kt)&&$(st)})}i(K);var ct=l(K,2);{var _=$=>{var O=Li(),Et=o(O),Q=l(o(Et),4),St=o(Q),Gt=l(St,2);i(Q),i(Et),i(O),R("click",St,_t),R("click",Gt,Y),w($,O)};wt(ct,$=>{t(G)&&$(_)})}lt(()=>{Ne(K,1,za(zt),"svelte-jdafhq"),nt(q,t(S))}),R("click",W,Z),w(f,T),me(),V()}const ea="reunion-phase2:grid-order:v2";async function Ri(){const f=aa();if(f?.length)return f;const x=await ja(),d=fa(x);return Qe(d),d}function aa(){try{const f=localStorage.getItem(ea);if(!f)return null;const x=JSON.parse(f);return Pi(x)?x:null}catch{return null}}function Qe(f){try{localStorage.setItem(ea,JSON.stringify(f))}catch{}}function Di(){localStorage.removeItem(ea)}function fa(f){const x=[...f];for(let d=x.length-1;d>0;d-=1){const U=Math.floor(Math.random()*(d+1));[x[d],x[U]]=[x[U],x[d]]}return x}function Pi(f){return Array.isArray(f)&&f.every(x=>typeof x=="string")}var Ii=C('<div class="info-chip summary-chip svelte-1mrulz2"><span aria-hidden="true">‚ÑπÔ∏è</span> </div>'),Oi=C('<div class="info-chip summary-chip error svelte-1mrulz2"><span aria-hidden="true">‚ö†</span> City insights not available.</div>'),Ni=C('<div class="info-chip svelte-1mrulz2"><span aria-hidden="true">üå§</span> </div>'),Bi=C('<div class="info-chip svelte-1mrulz2"><span aria-hidden="true">üçΩ</span> </div>'),Ui=C('<tr class="city-row svelte-1mrulz2"><th scope="row" class="city-col svelte-1mrulz2"><div class="city-card svelte-1mrulz2"><div class="row-bg svelte-1mrulz2"><!></div> <div class="row-content svelte-1mrulz2"><div class="city-headline svelte-1mrulz2"><div class="city-title svelte-1mrulz2"><span class="city-country svelte-1mrulz2"><span class="flag svelte-1mrulz2" aria-hidden="true"> </span> </span> <span class="city-name svelte-1mrulz2"> </span></div></div> <div class="meta-stack svelte-1mrulz2"><!> <!> <!></div></div></div></th><td class="utility-col svelte-1mrulz2"><!></td><td class="probability-col svelte-1mrulz2"><div class="probability-cell svelte-1mrulz2"><div class="input-stack svelte-1mrulz2"><!> <button type="button" class="row-reset svelte-1mrulz2"><span class="btn-icon svelte-1mrulz2" aria-hidden="true">‚ü≤</span> Reset</button></div></div></td></tr>'),Hi=C('<section class="grid-shell svelte-1mrulz2"><header class="grid-header svelte-1mrulz2"><!> <div class="toolbar svelte-1mrulz2"><!> <button type="button" class="svelte-1mrulz2"><span class="btn-icon svelte-1mrulz2" aria-hidden="true">‚Ü∫</span> Undo</button> <button type="button" class="svelte-1mrulz2"><span class="btn-icon svelte-1mrulz2" aria-hidden="true">‚Üª</span> Redo</button> <button type="button" class="svelte-1mrulz2"><span class="btn-icon svelte-1mrulz2" aria-hidden="true">üõ†</span> Bulk Actions</button></div></header> <div class="table-scroll svelte-1mrulz2"><table class="svelte-1mrulz2"><colgroup><col class="col-city svelte-1mrulz2"/><col class="col-utility svelte-1mrulz2"/><col class="col-probability svelte-1mrulz2"/></colgroup><thead class="svelte-1mrulz2"><tr><th scope="col" class="city-header svelte-1mrulz2">City</th><th scope="col" class="utility-header svelte-1mrulz2">Favorability</th><th scope="col" class="probability-header svelte-1mrulz2">Probability</th></tr></thead><tbody class="svelte-1mrulz2"></tbody></table></div> <!></section>');function Vi(f,x){be(x,!1);const d=()=>ue(da,"$citiesStore",v),U=()=>ue(Ca,"$citiesDocumentStore",v),X=()=>ue(ve,"$voteSessionStore",v),V=()=>ue(le,"$commandHistoryStore",v),S=()=>ue(Pe,"$settingsStore",v),[v,J]=ta(),G=Object.assign({"../data/static/meta/athens-greece.json":La,"../data/static/meta/bangkok-thailand.json":Ta,"../data/static/meta/belgrade-serbia.json":Aa,"../data/static/meta/bucharest-romania.json":Ra,"../data/static/meta/budapest-hungary.json":Da,"../data/static/meta/buenos-aires-argentina.json":Pa,"../data/static/meta/cairo-egypt.json":Ia,"../data/static/meta/cartagena-colombia.json":Oa,"../data/static/meta/casablanca-morocco.json":Na,"../data/static/meta/chiang-mai-thailand.json":Ba,"../data/static/meta/delhi-india.json":Ua,"../data/static/meta/doha-qatar.json":Ha,"../data/static/meta/dubai-uae.json":Va,"../data/static/meta/dublin-ireland.json":Fa,"../data/static/meta/florence-italy.json":Ka,"../data/static/meta/guadalajara-mexico.json":Ga,"../data/static/meta/hanoi-vietnam.json":Ya,"../data/static/meta/helsinki-finland.json":Wa,"../data/static/meta/ho-chi-minh-city-vietnam.json":Xa,"../data/static/meta/hong-kong-hong-kong.json":Ja,"../data/static/meta/jakarta-indonesia.json":Za,"../data/static/meta/krakow-poland.json":Qa,"../data/static/meta/lima-peru.json":tn,"../data/static/meta/ljubljana-slovenia.json":en,"../data/static/meta/lyon-france.json":an,"../data/static/meta/madrid-spain.json":nn,"../data/static/meta/manila-philippines.json":on,"../data/static/meta/marrakesh-morocco.json":rn,"../data/static/meta/mendoza-argentina.json":ln,"../data/static/meta/mumbai-india.json":sn,"../data/static/meta/munich-germany.json":cn,"../data/static/meta/nairobi-kenya.json":un,"../data/static/meta/nicosia-cyprus.json":dn,"../data/static/meta/prague-czech-republic.json":vn,"../data/static/meta/quito-ecuador.json":fn,"../data/static/meta/rio-de-janeiro-brazil.json":pn,"../data/static/meta/rotterdam-netherlands.json":bn,"../data/static/meta/santiago-chile.json":mn,"../data/static/meta/sao-paulo-brazil.json":_n,"../data/static/meta/seoul-south-korea.json":hn,"../data/static/meta/seville-spain.json":gn,"../data/static/meta/stockholm-sweden.json":yn,"../data/static/meta/taipei-taiwan.json":wn,"../data/static/meta/tashkent-uzbekistan.json":xn,"../data/static/meta/template.json":En,"../data/static/meta/thessaloniki-greece.json":Sn,"../data/static/meta/tunis-tunisia.json":zn,"../data/static/meta/vienna-austria.json":kn,"../data/static/meta/warsaw-poland.json":jn,"../data/static/meta/zagreb-croatia.json":qn}),kt=/\/meta\/([^/]+)\.json$/,jt={};for(const[u,c]of Object.entries(G)){const e=kt.exec(u);if(!e)continue;const n=e[1],s=qa.parse(c);jt[n]=s}const $t={Greece:"üá¨üá∑",Thailand:"üáπüá≠",Serbia:"üá∑üá∏",Argentina:"üá¶üá∑",Romania:"üá∑üá¥",Hungary:"üá≠üá∫",Egypt:"üá™üá¨",Morocco:"üá≤üá¶",Ireland:"üáÆüá™",UAE:"üá¶üá™",Italy:"üáÆüáπ",Vietnam:"üáªüá≥",Finland:"üá´üáÆ","Hong Kong":"üá≠üá∞",Peru:"üáµüá™",France:"üá´üá∑",Spain:"üá™üá∏",Philippines:"üáµüá≠",Germany:"üá©üá™",Cyprus:"üá®üáæ","Czech Republic":"üá®üáø",Brazil:"üáßüá∑",Netherlands:"üá≥üá±",Chile:"üá®üá±","South Korea":"üá∞üá∑",Sweden:"üá∏üá™",Taiwan:"üáπüáº",Uzbekistan:"üá∫üáø",Tunisia:"üáπüá≥",Croatia:"üá≠üá∑"};function At(u){return $t[u]??"üåç"}let Z=y([]),Y=y({}),_t=y([]),zt=y(null),T=y(ve.getSnapshot()),K=y({past:[],future:[]}),ot=y();const xt=jt;let p=y(!1),z=y(null),r=y(!1),q=y([]),W=y([]);const bt={},st=["utility","probability"],ct=ze();let _=y(!1),$=y(!1),O=y([]),Et=y(!1);function Q(u,c){const e=c.detail.value;Ut(u,"utility",e)}function St(u,c){const e=c.detail.value;Ut(u,"probability",e)}function Gt(){On(),a(p,!0)}function D(){a(p,!1),Nn()}function qt(u){return xt[u]??null}function Ot(u){const c=qt(u);return c?.food_and_drink?.length?c.food_and_drink.slice(0,2).join(" ‚Ä¢ "):null}function Pt(u){return qt(u)?.seasonal_notes??null}function Yt(){ct("reset")}function Bt(){const u=t(Z).map(c=>c.id);return fa(u)}function Wt(u){const{actions:c}=u.detail;if(!c||c.length===0){D();return}const e={},n=b=>Math.max(0,Math.min(100,Math.round(b))),s=(b,L)=>{const B=e[b];if(B&&B[L]!==void 0){const rt=B[L];return typeof rt=="number"?rt:0}const mt=t(T).entries[b]?.[L]??null;return typeof mt=="number"?mt:0},g=(b,L,B)=>{let A=e[b];A||(A={},e[b]=A),A[L]=n(B)},E=t(Z).map(b=>b.id),M={};for(const b of t(Z))(M[b.continent]??=[]).push(b.id);const N=(b,L,B)=>{for(const A of b)g(A,L,B)},pt=(b,L,B)=>{for(const A of b){const mt=s(A,L);g(A,L,mt+B)}};for(const b of c)switch(b.type){case"setAllProbabilities":N(E,"probability",b.value);break;case"setAllUtilities":N(E,"utility",b.value);break;case"adjustAllUtilities":pt(E,"utility",b.delta);break;case"adjustAllProbabilities":pt(E,"probability",b.delta);break;case"normalizeProbabilities":{const L=n(b.target),B=E.map(mt=>s(mt,"probability")),A=B.reduce((mt,rt)=>mt+rt,0)/(B.length||1);if(A===0)N(E,"probability",L);else{const mt=L/A;B.forEach((rt,Lt)=>{const It=n(rt*mt);g(E[Lt],"probability",It)})}break}case"setContinentUtility":{const L=M[b.continent]??[];N(L,"utility",b.value);break}case"adjustContinentUtility":{const L=M[b.continent]??[];pt(L,"utility",b.delta);break}case"setContinentProbability":{const L=M[b.continent]??[];N(L,"probability",b.value);break}case"adjustContinentProbability":{const L=M[b.continent]??[];pt(L,"probability",b.delta);break}}const Ct=[];for(const[b,L]of Object.entries(e)){const B=t(T).entries[b],A={};let mt=!1;if(L.utility!==void 0){const rt=n(L.utility);(B?.utility??null)!==rt&&(A.utility=rt,A.autoFilled=!1,mt=!0)}if(L.probability!==void 0){const rt=n(L.probability);(B?.probability??null)!==rt&&(A.probability=rt,mt=!0)}mt&&Ct.push({cityId:b,updates:A})}Ct.length!==0&&(le.execute({label:`Bulk actions (${Ct.length} cities)`,scope:["vote"],perform:()=>{for(const{cityId:b,updates:L}of Ct)ve.updateEntry(b,L)}}),$a(`Applied bulk actions to ${Ct.length} ${Ct.length===1?"city":"cities"}.`))}function Xt(u){return t(T).entries[u]??{cityId:u,utility:null,probability:null,autoFilled:!1}}function Ut(u,c,e){if((t(T).entries[u]?.[c]??null)===e)return;const g=c==="utility"?{utility:e,autoFilled:!1}:{probability:e};le.execute({label:`${c==="utility"?"Favorability":"Probability"} ‚Üí ${u}`,scope:["vote"],perform:()=>{ve.updateEntry(u,g)}})}function Ht(u){t(T).entries[u]&&le.execute({label:`Reset ${u}`,scope:["vote"],perform:()=>ve.resetCity(u)})}function yt(u,c,e){if(!e)return;e.dataset.cityId=u,e.dataset.column=c;const n=bt[u]??{};n[c]=e,bt[u]=n}function Rt(u,c,e){const n=bt[u];n&&n[c]===e&&(delete n[c],bt[u]=n)}function tt(u,c,e=!1){const s=bt[u]?.[c];return!s||"disabled"in s&&s.disabled?!1:(s.focus(),typeof s.select=="function"&&s.select(),e&&setTimeout(()=>{s.dispatchEvent(new CustomEvent("auto-open",{bubbles:!1}))},0),!0)}function Jt(u,c,e=!0){if(tt(u,c,e)||!t(z))return;const n=t(z).querySelector(`tr[data-row="${u}"]`);n&&(n.scrollIntoView({block:"center",behavior:"smooth"}),setTimeout(()=>{tt(u,c,e)},120))}function h(u,c,e){const n=st.length,s=t(q).findIndex(Ct=>Ct.city.id===u);if(s===-1)return;const g=st.indexOf(c);if(g===-1)return;const E=s*n+g,M=Math.min(t(q).length*n-1,Math.max(0,E+e)),N=t(q)[Math.floor(M/n)],pt=st[M%n];N&&Jt(N.city.id,pt)}function m(u){const{key:c}=u;if(!["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End"].includes(c))return;const e=u.target;if(!(e instanceof HTMLElement))return;const n=e.dataset.cityId,s=e.dataset.column;if(!n||!s)return;let g=t(Z).findIndex(pt=>pt.id===n);if(g===-1)return;let E=st.indexOf(s);if(E===-1)return;switch(u.preventDefault(),c){case"ArrowUp":g=Math.max(0,g-1);break;case"ArrowDown":g=Math.min(t(Z).length-1,g+1);break;case"ArrowLeft":E>0?E-=1:g>0&&(g-=1,E=st.length-1);break;case"ArrowRight":E<st.length-1?E+=1:g<t(Z).length-1&&(g+=1,E=0);break;case"Home":E=0;break;case"End":E=st.length-1;break}const M=t(Z)[g],N=st[E];Jt(M.id,N,!0)}function k(u){!(u.ctrlKey||u.metaKey)||u.key.toLowerCase()!=="z"||(u.preventDefault(),u.shiftKey?le.redo():le.undo())}function I(){le.undo()}function it(){le.redo()}Le(()=>(window.addEventListener("keydown",k),shuffleDisplayOrder(),()=>{window.removeEventListener("keydown",k)})),F(()=>d(),()=>{a(Z,d())}),F(()=>t(Z),()=>{a(Y,Object.fromEntries(t(Z).map(u=>[u.id,u])))}),F(()=>(t(Z),t(W),t(Y),Qe),()=>{if(t(Z).length&&t(W).length!==t(Z).length){const u=aa();if(u?.length===t(Z).length)a(W,u.filter(c=>t(Y)[c]));else{const c=Bt();a(W,c),Qe(c)}}}),F(()=>(t(W),t(Y)),()=>{a(_t,t(W).map(u=>t(Y)[u]).filter(u=>!!u))}),F(()=>U(),()=>{a(zt,U())}),F(()=>X(),()=>{a(T,X())}),F(()=>V(),()=>{a(K,V())}),F(()=>S(),()=>{a(ot,S())}),F(()=>(t(T),t(_t),t(Z)),()=>{t(T);const u=t(_t).length===t(Z).length&&t(_t).length>0?t(_t):t(Z);a(q,u.map((c,e)=>{const n=Xt(c.id);return{city:c,entry:n,index:e,meta:qt(c.id)}}))}),F(()=>t(K),()=>{a(_,(t(K).past??[]).length>0)}),F(()=>t(K),()=>{a($,(t(K).future??[]).length>0)}),F(()=>(t(ot),t(r)),()=>{a(Et,!!t(ot)?.countryKey&&!t(r))}),F(()=>(t(zt),t(Z)),()=>{a(O,t(zt)?.continents?.length?[...t(zt).continents]:Array.from(new Set(t(Z).map(u=>u.continent))).sort())}),xe(),pe();var vt=Hi(),ht=o(vt),ut=o(ht);Ai(ut,{inline:!0,$$events:{cleared:Yt}});var H=l(ut,2),Dt=o(H);ri(Dt,{});var P=l(Dt,2),et=l(P,2),dt=l(et,2);i(H),i(ht);var Nt=l(ht,2),Vt=o(Nt),ft=l(o(Vt),2);ne(ft,5,()=>t(q),u=>u.city.id,(u,c)=>{var e=Ui(),n=o(e),s=o(n),g=o(s),E=o(g);{let at=$e(()=>(t(c),j(()=>t(c).index%2===0?"normal":"reverse")));Ci(E,{get city(){return t(c),j(()=>t(c).city)},variant:"background",get direction(){return t(at)}})}i(g);var M=l(g,2),N=o(M),pt=o(N),Ct=o(pt),b=o(Ct),L=o(b,!0);i(b);var B=l(b);i(Ct);var A=l(Ct,2),mt=o(A,!0);i(A),i(pt),i(N);var rt=l(N,2),Lt=o(rt);{var It=at=>{var Ft=Ii(),he=l(o(Ft));i(Ft),lt(()=>nt(he,` ${t(c),j(()=>t(c).meta.summary)??""}`)),w(at,Ft)},Qt=at=>{var Ft=Oi();w(at,Ft)};wt(Lt,at=>{t(c),j(()=>t(c).meta)?at(It):at(Qt,!1)})}var ie=l(Lt,2);{var _e=at=>{var Ft=Ni(),he=l(o(Ft));i(Ft),lt(ge=>nt(he,` ${ge??""}`),[()=>(t(c),j(()=>Pt(t(c).city.id)))]),w(at,Ft)};wt(ie,at=>{t(c),j(()=>Pt(t(c).city.id))&&at(_e)})}var se=l(ie,2);{var te=at=>{var Ft=Bi(),he=l(o(Ft));i(Ft),lt(ge=>nt(he,` ${ge??""}`),[()=>(t(c),j(()=>Ot(t(c).city.id)))]),w(at,Ft)};wt(se,at=>{t(c),j(()=>Ot(t(c).city.id))&&at(te)})}i(rt),i(M),i(s),i(n);var ee=l(n),ce=o(ee);Tn(ce,{get value(){return t(c),j(()=>t(c).entry.utility)},$$events:{commit:at=>Q(t(c).city.id,at),register:at=>yt(t(c).city.id,"utility",at.detail.element),unregister:at=>Rt(t(c).city.id,"utility",at.detail.element),advance:at=>h(t(c).city.id,"utility",at.detail?.direction??1,at.detail?.open??!0)}}),i(ee);var oe=l(ee),re=o(oe),ke=o(re),je=o(ke);Pn(je,{get value(){return t(c),j(()=>t(c).entry.probability)},$$events:{commit:at=>St(t(c).city.id,at),register:at=>yt(t(c).city.id,"probability",at.detail.element),unregister:at=>Rt(t(c).city.id,"probability",at.detail.element),advance:at=>h(t(c).city.id,"probability",at.detail?.direction??1,at.detail?.open??!0)}});var Te=l(je,2);i(ke),i(re),i(oe),i(e),lt(at=>{fe(e,"data-row",(t(c),j(()=>t(c).city.id))),nt(L,at),nt(B,` ${t(c),j(()=>t(c).city.country)??""}`),nt(mt,(t(c),j(()=>t(c).city.name)))},[()=>(t(c),j(()=>At(t(c).city.country)))]),R("click",Te,()=>Ht(t(c).city.id)),w(u,e)}),i(ft),i(Vt),i(Nt),we(Nt,u=>a(z,u),()=>t(z));var Mt=l(Nt,2);Fn(Mt,{get open(){return t(p)},get continents(){return t(O)},$$events:{cancel:D,apply:Wt}}),i(vt),lt(()=>{P.disabled=!t(_),et.disabled=!t($)}),R("click",P,I),R("click",et,it),R("click",dt,Gt),R("keydown",Vt,m),w(f,vt),me(),J()}var Fi=C(`<section class="hero svelte-yczqw6"><h1 class="svelte-yczqw6">Phase 2 Ballot Guide</h1> <p class="lede svelte-yczqw6">Record personal utility U(c) on a 0‚Äì100 scale for each finalist city and estimate your attendance probability P(c) as a percentage. Everything stays local until you export the JSON ballot.</p> <section class="phase-cards svelte-yczqw6"><article class="svelte-yczqw6"><h2>Phase 0 ¬∑ Externality</h2> <ul class="svelte-yczqw6"><li>Each voter valued a hypothetical ‚Äú+1 extra attendee.‚Äù</li> <li>Responses combined via 10% trimmed mean (median fallback if &lt;10 voters).</li> <li class="svelte-yczqw6">The shared externality constant is <strong class="svelte-yczqw6">E = 24.4</strong>.</li></ul></article> <article class="svelte-yczqw6"><h2>Phase 1 ¬∑ Pruning</h2> <ul class="svelte-yczqw6"><li>A binary vote trimmed 86 nominees down to the top 37 (plus ties).</li> <li>That survivor list became the finalist pool you are filling out now.</li> <li>Round totals (S1) were published for transparency.</li></ul></article> <article class="current svelte-yczqw6"><h2>Phase 2 ¬∑ Your Ballot</h2> <span class="current-tag svelte-yczqw6">Current step</span> <ul class="svelte-yczqw6"><li>Enter personal utility U(c) for every finalist.</li> <li>Estimate attendance probability P(c); values are not auto-normalized.</li> <li>Export JSON mirrors these entries exactly for Phase 3 submission.</li></ul></article> <article class="svelte-yczqw6"><h2>Phase 3 ¬∑ Aggregation</h2> <ul class="svelte-yczqw6"><li>Coordinators aggregate attendance (Att) and expected utility (EU) across ballots.</li> <li>TEW(c) = EU(c) + (24.4 √ó N) √ó Att(c); highest TEW wins after tie-breakers.</li> <li>Tie-break order: higher Att, higher median U among P‚â•50%, higher overall median U.</li></ul></article></section> <section class="framework svelte-yczqw6"><h3 class="svelte-yczqw6">Total Expected Welfare snapshot</h3> <pre class="svelte-yczqw6">TEW(c) = EU(c) + (24.4 √ó N) √ó Att(c)</pre> <p>Att(c) is the expected attendee count (Œ£ P_i(c)/100) and EU(c) is the expected personal utility (Œ£ (P_i(c)/100) √ó U_i(c)). During Phase 3 the coordinators compute these values from the exported ballots and publish the full scoring table.</p> <h3 class="svelte-yczqw6">Next-year accountability</h3> <p>If a voter reports a high probability for the winning city but skips the reunion without force-majeure proof, next year's ballot is scaled by 1 ‚àí P<sub>winning</sub>/200. Accurate percentages keep your future weight intact.</p></section> <footer class="modal-footer svelte-yczqw6"><button type="button" class="primary svelte-yczqw6">Start filling the grid</button></footer></section>`);function Ki(f,x){be(x,!1);let d=Kt(x,"open",8,!1);const U=ze();function X(){U("close")}pe();var V=ae(),S=Zt(V);{var v=J=>{var G=Fi(),kt=l(o(G),8),jt=o(kt);i(kt),i(G),R("click",jt,X),w(J,G)};wt(S,J=>{d()&&J(v)})}w(f,V),me()}var Gi=C('<div class="page-container svelte-1uha8ag"><div class="countdown-banner svelte-1uha8ag" aria-live="polite"> </div> <!></div>');function tr(f,x){be(x,!1);const d="reunion-phase2:phase-explainer-dismissed:v1",U="v1",X=Date.UTC(2025,10,28,21,0,0);let V=y(!1),S=Z(X-Date.now()),v=Y(S),J=y(_t(v)),G=y(zt(S)),kt=null;Le(()=>{Pe.update(W=>W.preferredMode==="grid"?W:{...W,preferredMode:"grid"}),typeof ve.setMode=="function"&&ve.setMode("grid");const r=localStorage.getItem(d),q=!!aa();a(V,r!==U||!q),We.set(t(V)),At(),kt=setInterval(At,3e4)}),Oe(()=>{kt&&(clearInterval(kt),kt=null)});async function jt(){a(V,!1),await Ri(),localStorage.setItem(d,U),requestAnimationFrame(()=>window.scrollTo({top:0,behavior:"smooth"})),We.set(!1)}function $t(){localStorage.removeItem(d),Di(),a(V,!0),We.set(!0)}function At(){const r=X-Date.now();S=Z(r),v=Y(S),a(J,_t(v)),a(G,zt(S))}function Z(r){if(r<=0)return"Voting closed";const q=Math.max(0,Math.floor(r/6e4)),W=Math.floor(q/1440),bt=Math.floor((q-W*24*60)/60),st=q%60,ct=String(bt).padStart(2,"0"),_=String(st).padStart(2,"0");return`${W}d ${ct}:${_}`}function Y(r){return r==="Voting closed"?r:`Voting ends in ${r} GMT`}function _t(r){const q="Reunion 2026 ‚Äî Lightning Grid";return r?`${q} (${r})`:q}function zt(r){return r==="Voting closed"?"Voting closed on Fri Nov 28, 2025 at 21:00 GMT":`Voting closes in ${r} (Fri Nov 28, 2025 ¬∑ 21:00 GMT)`}pe();var T=Gi();Ma("1uha8ag",r=>{lt(()=>wa.title=t(J)??"")});var K=o(T),ot=o(K,!0);i(K);var xt=l(K,2);{var p=r=>{Ki(r,{open:!0,$$events:{close:jt}})},z=r=>{Vi(r,{$$events:{reset:$t}})};wt(xt,r=>{t(V)?r(p):r(z,!1)})}i(T),lt(()=>nt(ot,t(G))),w(f,T),me()}export{tr as component};
